!function(a,b){var c={Esc:27,Space:32,Left:37,Right:39,Up:38,Down:40,Tab:9,Enter:13},d={fixed:!0,overlay:!0,overlayEvent:"flash",id:0,open:!1,drag:window,resize:!0,title:!1,type:"html",content:!1,icons:[],buttons:[],buttonEvents:{},keyEvents:{Esc:"close",Space:"play",Left:"prev",Right:"next",Enter:"play"},prefix:"jMsgbox",width:600,height:450,initialWidth:350,initialHeight:220,top:!1,left:!1,titleHeight:30,footHeight:40,transition:"swing",speed:300,opacity:.9,zIndex:99,lang:"en",minPos:"top",minWidth:200,photoAuto:!0,photoSpeed:2500,photoScaled:!1,photoFade:500,padding:0,imgError:"Failed to load image.",xhrError:"Failed to load URL.",onOpen:!1,onClose:!1,onLoad:!1,onBeforeClose:!1},e=function(b,c,d,e){return d=d||{},e=e||{},a(document.createElement(b)).addClass(c).attr(e).css(d)},f=function(){return window.innerHeight?window.innerHeight:a(window).height()},g=function(b,c){return a.msgboxI18N&&a.msgboxI18N[c]&&a.msgboxI18N[c][b]?a.msgboxI18N[c][b]:b},h=function(a,b){this.$overlay,this.$wrap,this.$controls,this.$icons={},this.$title,this.$content,this.$loaded,this.$prompt,this.$iframe,this.$foot,this.$img,this.$buttons={},this.$resize,this.$trigger=a,this.options=b,this.v,this.loaded=!1,this.minimized=!1,this.maximized=!1,this.opened=!1,this.dragData={},this.resizeData={},this.playing=!1,this.titleSpecified=!1,this.index=0,this._completeOptions(),this._assemble(),this._append(),this._bindEvents(),this.options.open&&this.open()};h.prototype={_completeOptions:function(){switch(this.options.type){case"confirm":case"prompt":null!==this.options.buttons&&0==this.options.buttons.length&&(this.options.buttons=["OK","Cancel"]),null!==this.options.icons&&0==this.options.icons.length&&(this.options.icons=["close"]),this.options.width==d.width&&this.options.height==d.height&&(this.options.width=this.options.initialWidth,this.options.height=this.options.initialHeight);break;case"alert":case"warning":case"info":case"error":case"success":null!==this.options.buttons&&0==this.options.buttons.length&&(this.options.buttons=["OK"]),null!==this.options.icons&&0==this.options.icons.length&&(this.options.icons=["close"]),this.options.width==d.width&&this.options.height==d.height&&(this.options.width=this.options.initialWidth,this.options.height=this.options.initialHeight);break;case"photo":case"image":this.$trigger&&!this.options.content&&(this.options.content=this.$trigger),null!==this.options.icons&&0==this.options.icons.length&&(this.options.icons=["close"]),this.options.resize=!1;break;case"album":case"gallery":this.$trigger&&!this.options.content&&(this.options.content=this.$trigger.selector),null!==this.options.icons&&0==this.options.icons.length&&(this.options.icons=["prev","play","next","close"]),this.options.resize=!1;break;default:null!==this.options.icons&&0==this.options.icons.length&&(this.options.icons=["max","close"])}a.inArray(this.options.type,["ajax","iframe"])>-1&&!this.options.content&&this.$trigger&&(this.options.content=this.$trigger.attr("href")),this.options.width||(this.options.width=this.options.initialWidth),this.options.height||(this.options.height=this.options.initialHeight),this.options.content||-1!=a.inArray(this.options.type,["ajax","iframe","photo","image","album","gallery"])||(this.options.content="jquery.msgbox v "+a.msgbox.version),null!==this.options.buttons&&0!=this.options.buttons.length||(this.options.footHeight=0),this.$trigger&&(this.options.id=0),this.options.title&&(this.titleSpecified=!0),!0===this.options.photoFade&&(this.options.photoFade=d.photoFade),!1===this.options.photoFade&&(this.options.photoFade=0),a.msgboxI18N=a.msgboxI18N||{},a.msgboxI18N.en=a.msgboxI18N.en||{},a.msgboxI18N.en.xhrError=a.msgboxI18N.en.xhrError||this.options.xhrError,a.msgboxI18N.en.imgError=a.msgboxI18N.en.imgError||this.options.imgError},_assemble:function(){this.$overlay=e("div",this.options.prefix+"-overlay",{position:"fixed",top:0,left:0,height:"100%",width:"100%",opacity:this.options.opacity,display:"none"});var b=!1!==this.options.top?this.options.top:(f()-this.options.initialHeight)/2-this.options.titleHeight,c=!1!==this.options.left?this.options.left:(a(window).width()-this.options.initialWidth)/2;this.$wrap=e("span",this.options.prefix+"-wrap",{display:"none",width:this.options.initialWidth,height:this.options.initialHeight,position:this.options.fixed?"fixed":"absolute",overflow:"hidden",top:this.options.fixed?b:b+a(window).scrollTop(),left:this.options.fixed?c:c+a(window).scrollLeft()}),this.$title=e("div",this.options.prefix+"-title",{position:"relative",height:this.options.titleHeight,cursor:this.options.drag?"move":"auto"}),this.options.title&&this.$title.html(this.options.title);var d={display:"inline-block"};if(this.$icons.prev=e("a",this.options.prefix+"-prev",d,{href:"javascript:;",title:g("Prev",this.options.lang)}),this.$icons.next=e("a",this.options.prefix+"-next",d,{href:"javascript:;",title:g("Next",this.options.lang)}),this.$icons.play=e("a",this.options.prefix+"-play",d,{href:"javascript:;",title:g("Play/Pause",this.options.lang)}),this.$icons.min=e("a",this.options.prefix+"-min",d,{href:"javascript:;",title:g("Minimize",this.options.lang)}),this.$icons.max=e("a",this.options.prefix+"-max",d,{href:"javascript:;",title:g("Maximize",this.options.lang)}),this.$icons.close=e("a",this.options.prefix+"-close",d,{href:"javascript:;",title:g("Close",this.options.lang)}),this.$controls=e("span",this.options.prefix+"-controls",{position:"absolute",height:"100%"}),null!==this.options.icons)for(var h=0;h<this.options.icons.length;h++)this.$controls.append(this.$icons[this.options.icons[h]]);var i={type:"button"};if(this.$buttons.OK=e("input",this.options.prefix+"-ok",{},i),this.$buttons.Cancel=e("input",this.options.prefix+"-cancel",{},i),this.$buttons.OK.val(g("OK",this.options.lang)),this.$buttons.Cancel.val(g("Cancel",this.options.lang)),this.$foot=e("div",this.options.prefix+"-foot",{position:"relative",height:this.options.footHeight,"line-height":this.options.footHeight}),null!==this.options.buttons)for(var j=0,h=0;h<this.options.buttons.length;h++)this.$buttons[this.options.buttons[h]]||(this.$buttons[this.options.buttons[h]]=e("input",this.options.prefix+"-button-"+ ++j,{},i).val(this.options.buttons[h])),this.$foot.append(this.$buttons[this.options.buttons[h]]);this.$resize=e("a",this.options.prefix+"-resize",{cursor:"se-resize",position:"absolute",bottom:"0px",right:"0px",display:"inline-block"},{href:"javascript:;"}),a.support.boxSizing||this.$resize.css({right:"5px",bottom:"5px"}),this.$content=e("div",this.options.prefix+"-content",{overflow:"hidden",position:"relative"}),this.$prompt=e("input",this.options.prefix+"-prompt-input",{},{type:"text"}),this.$loaded=e("div",this.options.prefix+"-loaded",{padding:this.options.padding,width:"100%",height:"100%",overflow:-1==a.inArray(this.options.type,["photo","image","album","gallery"])?"auto":"hidden"}),this.$loading=e("div",this.options.prefix+"-loading",{height:"100%",width:"100%"})},_append:function(){this.options.overlay&&a(document.body).append(this.$overlay),a(document.body).append(this.$wrap.append(this.$title.append(this.$controls),this.$content.append(this.$loaded))),null!==this.options.buttons&&this.options.buttons.length>0?(this.$foot.appendTo(this.$wrap),this.options.resize&&this.$resize.appendTo(this.$foot)):this.options.resize&&this.$resize.appendTo(this.$content)},_bindEvents:function(){var d=this;if(this.$trigger&&this.$trigger.bind("click."+this.options.prefix,function(a){a.preventDefault(),d.focus()}),this.enableResize(),this.enableDrag(),this.options.overlay&&this.options.overlayEvent){var e=!1;a.isFunction(this.options.overlayEvent)?e=this.options.overlayEvent:a.isFunction(this[this.options.overlayEvent])&&(e=this[this.options.overlayEvent]),e&&this.$overlay.bind("click."+this.options.prefix,function(){e.apply(d)})}switch(this.options.type){case"confirm":this.options.buttonEvents.OK||(this.options.buttonEvents.OK=function(){this.close(function(){this.v=!0})}),this.options.buttonEvents.Cancel||(this.options.buttonEvents.Cancel=function(){this.close(function(){this.v=!1})});break;case"prompt":this.options.buttonEvents.OK||(this.options.buttonEvents.OK=function(){this.close(function(){this.v=this.$prompt.val()})}),this.options.buttonEvents.Cancel||(this.options.buttonEvents.Cancel=function(){this.close(function(){this.v=b})});break;default:this.options.buttonEvents.OK||(this.options.buttonEvents.OK="close")}a.each(this.options.buttonEvents,function(b,c){a.isFunction(c)||(c=!!a.isFunction(d[c])&&d[c]),c&&d.$buttons[b].bind("click."+d.options.prefix,function(){c.apply(d)})}),a.each(this.$icons,function(a,b){var c;switch(a){case"close":c=function(a){a.stopPropagation(),d.close()},b.bind("click."+d.options.prefix,c);break;case"max":c=function(a){a.stopPropagation(),d.max()},b.unbind("click.max."+d.options.prefix).one("click.max."+d.options.prefix,c);break;case"min":c=function(a){a.stopPropagation(),d.min()},b.unbind("click.min."+d.options.prefix).one("click.min."+d.options.prefix,c);break;case"play":c=function(a){a.stopPropagation(),d.play()},b.bind("click.play."+d.options.prefix,c);break;case"prev":c=function(a){a.stopPropagation(),d.prev()},b.bind("click.prev."+d.options.prefix,c);break;case"next":c=function(a){a.stopPropagation(),d.next()},b.bind("click.next."+d.options.prefix,c)}}),this.$wrap.bind("mousedown."+d.options.prefix,function(){a(this).css("z-index",++a.msgbox._zIndex),a.msgbox._focused=d}),a.each(this.options.keyEvents,function(b,e){(b=c[b]||b)&&(a.isFunction(e)||(e=!!a.isFunction(d[e])&&d[e]),e&&a(document).bind("keydown."+d.options.prefix,function(c){c.keyCode===b&&a.msgbox._focused==d&&e.apply(d)}))})},_loadImg:function(c,d){if(c&&0!=c.length){var f=this;this.$loading=e("div",this.options.prefix+"-loading",{height:"100%",width:"100%"}).appendTo(this.$loaded),this.titleSpecified||this.title(c.attr("title"));var h=function(){if(f.$loading.remove(),f.$loading=b,f.options.photoScaled){var a=f.options.height-f.options.titleHeight-f.options.footHeight,c=f.$img.outerHeight(!0),e=f.$img.outerWidth(!0),g=1;c>a&&(g=a/c),e*g>f.options.width&&(g=f.options.width/e);var h=e*g,i=c*g;f.$img.css({position:"absolute",width:e*g+"px",height:c*g+"px"}),i<=a&&f.$img.css("top",(a-i)/2+"px"),h<=f.options.width&&f.$img.css("left",(f.options.width-h)/2+"px")}else f.options.height=f.$img.outerHeight(!0)+f.options.titleHeight+f.options.footHeight,f.options.width=f.$img.outerWidth(!0);f.$img.fadeIn(f.options.photoFade),f.loaded=!0,f.options.onLoad&&f.options.onLoad.apply(f),d&&d.apply(f)};this.$img||(this.$img=e("img",this.options.prefix+"-photo"),a.each(["alt","longdesc","aria-describedby"],function(a,b){var d=c.attr(b)||c.attr("data-"+b)||"";f.$img.attr(b,d)}),this.$img.hide().appendTo(this.$loaded).error(function(){f.$loading.remove(),f.$loading=b,f.loaded=!0,f.content(g("imgError",f.options.lang))})),this.$img.hide().unbind("load."+this.options.prefix).bind("load."+this.options.prefix,h),setTimeout(function(){f.$img.attr("src",c.attr("href"))},1)}},_load:function(c){if(!this.loaded)switch(this.options.type){case"text":this.$loaded.text(this.options.content),this.loaded=!0,c&&c.apply(this),this.options.onLoad&&this.options.onLoad.apply(this);break;case"html":var d="object"===a.type(this.options.content)?this.options.content.show():this.options.content;this.$loaded.append(d),this.loaded=!0,c&&c.apply(this),this.options.onLoad&&this.options.onLoad.apply(this);break;case"alert":case"warning":case"info":case"error":case"success":case"confirm":var d="object"===a.type(this.options.content)?this.options.content.show():this.options.content;this.$loaded.append(d).addClass(this.options.prefix+"-shortcut "+this.options.prefix+"-"+this.options.type),this.loaded=!0,c&&c.apply(this),this.options.onLoad&&this.options.onLoad.apply(this);break;case"prompt":var d="object"===a.type(this.options.content)?this.options.content.show():this.options.content;this.$loaded.append(d).append(this.$prompt).addClass(this.options.prefix+"-shortcut "+this.options.prefix+"-"+this.options.type),this.loaded=!0,c&&c.apply(this),this.options.onLoad&&this.options.onLoad.apply(this);break;case"ajax":this.$loading=e("div",this.options.prefix+"-loading",{height:"100%",width:"100%"}).appendTo(this.$content);var f=this;this.$loaded.load(this.options.content,function(a,d){f.$loading.remove(),f.$loading=b,f.$loaded.appendTo(f.$content),"error"==d&&f.$loaded.html(g("xhrError",f.options.lang)),f.loaded=!0,c&&c.apply(f),f.options.onLoad&&f.options.onLoad.apply(f)});break;case"photo":case"image":var h=a(this.options.content);this._loadImg(h,c);break;case"album":case"gallery":var i=this.$trigger?this.$trigger.index(this.options.content):0;this.index=i<0?0:i;var h=a(this.options.content).eq(this.index),f=this;this._loadImg(h,function(){f.$img.unbind("click."+f.options.prefix).bind("click."+f.options.prefix,function(){f.next()}),c&&c.apply(f)});break;case"iframe":var j=e("div",this.options.prefix+"-loading",{height:this.$content.innerHeight()+"px",width:"100%"}).appendTo(this.$content);this.options.title||(this.title(g("Loading",this.options.lang)+" ..."),this.options.title=!1);var f=this;this.$iframe=e("iframe",this.options.prefix+"-iframe",{height:"100%",width:"100%",border:"none",display:"none"},{frameborder:0,marginheight:"0px",marginwidth:"0px",scrolling:"auto",src:this.options.content}).appendTo(f.$loaded).one("load",function(){if(j.remove(),f.$iframe.show(),!f.options.title){var b="";try{b=a("title",f.$iframe.contents()).text()}catch(a){}f.title(b)}f.loaded=!0,f.options.onLoad&&f.options.onLoad.apply(f),c&&c.apply(f)})}},_restoreFromMin:function(a){if(this.minimized){var b=this;this.animate(this.minimized,function(){b.minimized=!1,b.$icons.min.removeClass(b.options.prefix+"-restore"),b.$wrap.css("position",b.options.fixed?"fixed":"absolute"),b.$icons.min.unbind("click.min."+b.options.prefix).one("click.min."+b.options.prefix,function(){b.min()}),b.enableDrag(),b.enableResize(),a&&a.apply(b)})}},_min:function(a,b){if(!this.minimized){var c={width:parseInt(this.$wrap.css("width")),height:parseInt(this.$wrap.css("height")),top:parseInt(this.$wrap.css("top")),left:parseInt(this.$wrap.css("left"))},d=this;this.animate(a,function(){d.minimized=c,d.$icons.min.addClass(d.options.prefix+"-restore"),d.$wrap.css("position","fixed"),d.$icons.min.unbind("click.restore."+d.options.prefix).one("click.restore."+d.options.prefix,function(){d.restore()}),this.$trigger||d.disableDrag(),d.disableResize(),b&&b.apply(d)})}},enableDrag:function(){if(!1!==this.options.drag){var c=this;this.$title.css("cursor","move").bind("mousedown.drag."+this.options.prefix,function(d){c.dragData.x=d.pageX,c.dragData.y=d.pageY,c.dragData.top=parseInt(c.$wrap.css("top")),c.dragData.left=parseInt(c.$wrap.css("left")),c.dragData.width=parseInt(c.$wrap.css("width")),c.dragData.height=parseInt(c.$wrap.css("height")),a(document).one("mouseup.drag."+c.options.prefix,function(b){c.dragData={},a(this).unbind(" mousemove.drag."+c.options.prefix)}).bind("mousemove.drag."+c.options.prefix,function(d){if(d.preventDefault(),!a.isEmptyObject(c.dragData)){var e=c.dragData.left+d.pageX-c.dragData.x,f=c.dragData.top+d.pageY-c.dragData.y,g=c.dragData.width,h=c.dragData.height,i=a(c.options.drag);if(i.length>0){var j=i.offset();j||(j={left:0,top:0}),c.options.fixed||(j.left+=a(window).scrollLeft(),j.top+=a(window).scrollTop());var k=j.left,l=j.top,m=j.left+i.innerWidth(),n=j.top+i.innerHeight();e=e<=k?k:e,e=e+g>m?m-g:e,f=f+h>n?n-h:f,f=f<=l?l:f}c.animate({width:g,height:h,top:f,left:e},b,0)}})})}},disableDrag:function(){this.$title.css("cursor","auto").unbind("mousedown.drag."+this.options.prefix)},enableResize:function(){if(!1!==this.options.resize){var c=this;this.$resize.show().bind("mousedown.resize."+this.options.prefix,function(d){c.resizeData.x=d.pageX,c.resizeData.y=d.pageY,c.resizeData.width=parseInt(c.$wrap.css("width")),c.resizeData.height=parseInt(c.$wrap.css("height")),c.resizeData.top=parseInt(c.$wrap.css("top")),c.resizeData.left=parseInt(c.$wrap.css("left")),a(document).bind("mouseup.resize."+c.options.prefix,function(b){c.resizeData={},a(this).unbind("mouseup.resize."+c.options.prefix+" mousemove.resize."+c.options.prefix)}).bind("mousemove.resize."+c.options.prefix,function(d){if(d.preventDefault(),!a.isEmptyObject(c.resizeData)){var e=c.resizeData.width+d.pageX-c.resizeData.x,f=c.resizeData.height+d.pageY-c.resizeData.y;e=e<c.options.resize.width?c.options.resize.width:e,f=f<c.options.resize.height?c.options.resize.height:f,c.animate({width:e,height:f,top:c.resizeData.top,left:c.resizeData.left},b,0)}})})}},disableResize:function(){this.$resize.hide().unbind("mousedown.resize."+this.options.prefix)},animate:function(c,d,e){c=c||{},c=a.extend({},{top:this.options.top,left:this.options.left,width:this.options.width,height:this.options.height,opacity:1},c),e===b&&(e=this.options.speed);var g=(f()-c.height)/2-this.options.titleHeight,h=(a(window).width()-c.width)/2;g=g<0?0:g,!1===c.top&&(c.top=this.options.fixed?g:g+a(window).scrollTop()),!1===c.left&&(c.left=this.options.fixed?h:h+a(window).scrollLeft());var i=this;this.$overlay.fadeTo(e,this.options.opacity);var j=function(){i.$content.height(i.$wrap.height()-i.options.titleHeight-i.options.footHeight)};this.$wrap.dequeue().animate(c,{duration:e,complete:function(){j(),d&&d.apply(i)},step:j,easing:this.options.transition})},flash:function(b,c,d){b=b||.3,c=c||100;var e=this;this.$title.fadeTo(0,b).delay(c).fadeTo(0,1).delay(c).fadeTo(0,b).delay(c).fadeTo(0,1).queue(function(){d&&d.apply(e),a(this).dequeue()})},play:function(a){if("album"==this.options.type||"gallery"==this.options.type){if(this.playing&&-1!=this.playing&&-2!=this.playing)return void this.pause();var b=this;this.$icons.play.removeClass(this.options.prefix+"-pause"),this.playing=setTimeout(function(){b.next(a)},b.options.photoSpeed)}},pause:function(){if(("album"==this.options.type||"gallery"==this.options.type)&&this.playing&&-1!==this.playing&&-2!==this.playing){this.playing&&(clearTimeout(this.playing),this.playing=-1);this.$icons.play.addClass(this.options.prefix+"-pause")}},next:function(b){if("album"==this.options.type||"gallery"==this.options.type){this.index++,this.index=this.index>=a(this.options.content).length?0:this.index;var c=a(this.options.content).eq(this.index),d=this;d.playing&&-1!=d.playing&&-2!=d.playing&&clearTimeout(d.playing),this._loadImg(c,function(){d.playing&&-1!=d.playing&&-2!=d.playing&&(d.playing=setTimeout(function(){d.next(b)},d.options.photoSpeed)),d.animate(),b&&b.apply(d)})}},prev:function(b,c){if("album"==this.options.type||"gallery"==this.options.type){this.index--,this.index=this.index>=a(this.options.content).length?0:this.index;var d=a(this.options.content).eq(this.index),e=this;e.playing&&-1!=e.playing&&-2!=e.playing&&clearTimeout(e.playing),this._loadImg(d,function(){e.playing&&-1!=e.playing&&-2!=e.playing&&(e.playing=setTimeout(function(){e.next(c)},e.options.photoSpeed)),e.animate(),c&&c.apply(e)})}},open:function(c){if(!this.opened){this.$overlay.show().css("z-index",++a.msgbox._zIndex),this.$wrap.show().css("z-index",a.msgbox._zIndex),this.options.titleHeight=this.$title.outerHeight(!0),this.$title.css({"line-height":this.options.titleHeight+"px"}),this.options.footHeight>0&&(this.options.footHeight=this.$foot.outerHeight(!0),this.$foot.css({"line-height":this.options.footHeight+"px"})),this.$content.height(this.$wrap.height()-this.options.titleHeight-this.options.footHeight),!0===this.options.resize&&(this.options.resize={width:this.options.minWidth,height:null!==this.options.buttons&&this.options.buttons.length>0?this.options.titleHeight+this.options.footHeight+5:this.options.titleHeight+5});var d=this,e=function(){d.opened=!0,a.msgbox._focused=d,d.options.onOpen&&d.options.onOpen.apply(d),c&&c.apply(d)},f=function(){"album"!=d.options.type&&"gallery"!=d.options.type||!d.options.photoAuto||!d.options.photoSpeed||d.playing&&-2!=d.playing||d.play()};this.loaded?this.animate(b,function(){e(),f()}):this._load(function(){d.animate(b,e),f()})}},val:function(){return this.v},close:function(b){if(this.opened&&(!this.options.onBeforeClose||!1!==this.options.onBeforeClose.apply(this))){this.playing&&-1!=this.playing&&-2!=this.playing&&(clearTimeout(this.playing),this.playing=-2);var c=this,d=function(a){c.animate({width:c.options.initialWidth,height:c.options.initialHeight,opacity:0},function(){c.$overlay.fadeOut("fast",function(){c.opened=!1,c.$wrap.hide(),c.$overlay.hide(),a&&a.apply(c),c.options.onClose&&c.options.onClose.apply(c)})})};!this.$trigger&&this.minimized?a.msgbox._arrangeMin(this,"out",function(){d(b)}):d(b)}},remove:function(){this.$trigger&&this.$trigger.unbind("click."+this.options.prefix),this.$overlay.remove(),this.$wrap.remove()},title:function(c){if(c===b)return this.options.title;this.options.title=c;var d=this;return this.$title.contents().filter(function(){return 3==this.nodeType||!a(this).is(d.$controls)}).remove(),this.$title.prepend(c),this},reload:function(a){this.loaded=!1,"iframe"==this.options.type?this.$iframe.remove():this.$loaded&&this.$loaded.remove(),this._load(a)},focus:function(c){this.$overlay.css("z-index",++a.msgbox._zIndex),this.$wrap.css("z-index",a.msgbox._zIndex);var d=this;this.opened?this.minimized?this.restore(function(){a.msgbox._focused=d,c&&c.apply(d)}):this.flash(b,b,function(){a.msgbox._focused=d,c&&c.apply(d)}):this.open(c)},restore:function(b){if(this.minimized)this.$trigger?this._restoreFromMin(b):a.msgbox._arrangeMin(this,"out",b);else if(this.maximized){var c=this;this.animate(this.maximized,function(){c.maximized=!1,c.$icons.max.removeClass(c.options.prefix+"-restore"),c.$wrap.css("position",c.options.fixed?"fixed":"absolute"),c.$icons.max.unbind("click.max."+c.options.prefix).one("click.max."+c.options.prefix,function(){c.max()}),c.enableDrag(),c.enableResize(),b&&b.apply(c)})}},min:function(b){this.minimized?this.restore(b):this.$trigger?this._min({width:this.options.minWidth,height:this.options.titleHeight}):a.msgbox._arrangeMin(this,"in",b)},max:function(b){if(this.maximized)return void this.restore(b);var c=this,d=a.extend({},this.minized);if(this.minimized)this.minimized={top:0,left:0,width:a(window).width(),height:f()},a.msgbox._arrangeMin(this,"out",function(){c.maximized=d,c.$icons.max.addClass(c.options.prefix+"-restore"),c.$wrap.css("position","fixed"),c.$icons.max.unbind("click.restore."+c.options.prefix).one("click.restore."+c.options.prefix,function(){c.restore()}),c.disableDrag(),c.disableResize(),b&&b.apply(c)});else{var d={width:parseInt(this.$wrap.css("width")),height:parseInt(this.$wrap.css("height")),top:parseInt(this.$wrap.css("top")),left:parseInt(this.$wrap.css("left"))},c=this;this.animate({top:0,left:0,width:a(window).width(),height:f()},function(){c.maximized=d,c.$icons.max.addClass(c.options.prefix+"-restore"),c.$wrap.css("position","fixed"),c.$icons.max.unbind("click.restore."+c.options.prefix).one("click.restore."+c.options.prefix,function(){c.restore()}),c.disableDrag(),c.disableResize(),b&&b.apply(c)})}},content:function(a){return a===b?this.$loaded.html():(this.$loaded.html(a),!0)}},a.fn.msgbox=function(b){if("object"==typeof b){b=a.extend(!0,{},d,b);var c=a(this).selector;return this.each(function(){var d=a(this);d.selector=c;var e=new h(d,b);a(this).data("msgbox."+b.id,e)})}return b=b||0,a(this).data("msgbox."+b)},a.msgbox=function(c){if("object"==typeof c){var e=c.open===b||c.open;c=a.extend(!0,{},d,c);var f=a(document.body).data("msgbox."+c.id);return f=new h(!1,c),a(document.body).data("msgbox."+c.id,f),e&&f.open(),f}c=c||0;var f=a(document.body).data("msgbox."+c);return f},a.extend(a.msgbox,{defaults:function(b){a.extend(d,b),a.msgbox._zIndex=d.zIndex},version:"8.0",_focused:null,_zIndex:d.zIndex,closeAll:function(b){var c=a(document.body).data(),d=a({});a.each(c,function(a,b){0===a.indexOf("msgbox.")&&b.opened&&d.queue("closeAll",function(a){b.close(a)})}),b&&d.queue("closeAll",b),d.dequeue("closeAll")},restoreAll:function(b){var c=a(document.body).data(),d=a({});a.each(c,function(a,b){0===a.indexOf("msgbox.")&&b.minimized&&d.queue("restoreAll",function(a){b.restore(a)})}),b&&d.queue("restoreAll",b),d.dequeue("restoreAll")},minAll:function(b){var c=a(document.body).data(),d=a({});a.each(c,function(a,b){0!==a.indexOf("msgbox.")||b.minimized||d.queue("minAll",function(a){b.min(a)})}),b&&d.queue("minAll",b),d.dequeue("minAll")},_arrangeMin:function(b,c,d){var e=a(document.body).data();if(e){var g=[],h=0,i=0,j=[],k=3,l=a({});if(a.each(e,function(a,c){0!==a.indexOf("msgbox.")||!c.minimized&&a!="msgbox."+b.options.id||c.options.minPos!=b.options.minPos||(g[a]=c,j.push(a),h+=c.options.minWidth+k)}),j.sort(),i=a.inArray("msgbox."+b.options.id,j),"in"==c){var o,m=1,n=0;h>a(window).width()&&(m=a(window).width()/h),o=b.options.minWidth*m,a.each(j,function(a,c){if(a==i)l.queue("min",function(a){b._min({left:n,top:"bottom"==b.options.minPos?f()-b.options.titleHeight:0,width:o,height:b.options.titleHeight},function(){n+=o+k,a()})});else{var d=g[c].options.minWidth*m;l.queue("min",function(a){g[c].animate({left:n,top:"bottom"==g[c].options.minPos?f()-g[c].options.titleHeight:0,width:d,height:g[c].options.titleHeight},function(){n+=d+k,a()},50)})}})}else{h-=b.options.minWidth;var m=1;h>a(window).width()&&(m=a(window).width()/h);var n=0;l.queue("min",function(a){b._restoreFromMin(a)}),a.each(j,function(a,c){a!=i&&l.queue("min",function(a){var d=g[c].options.minWidth*m;g[c].animate({left:n,top:"bottom"==b.options.minPos?f()-g[c].options.titleHeight:0,width:d,height:g[c].options.titleHeight},a,50),n+=d+k})})}d&&l.queue("min",d),l.dequeue("min")}}})}(jQuery,void 0);