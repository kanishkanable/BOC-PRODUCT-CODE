!function(a){var b,c,d,e,f,g,h;a.fn.cluetip=function(k,l){return"object"==typeof k&&(l=k,k=null),this.each(function(m){var n=a(this),o=a.extend(!1,{},a.fn.cluetip.defaults,l||{},a.metadata?n.metadata():a.meta?n.data():{}),p=!1,q=parseInt(o.cluezIndex,10)-1,r=!1,s=0;a("#cluetip").length||(c=a('<div id="cluetip-inner"></div>'),e=a('<h3 id="cluetip-title"></h3>'),d=a('<div id="cluetip-outer"></div>').append(c).prepend(e),b=a('<div id="cluetip"></div>').css({zIndex:o.cluezIndex}).append(d).append('<div id="cluetip-extra"></div>')[i](j).hide(),a('<div id="cluetip-waitimage"></div>').css({position:"absolute",zIndex:q-1}).insertBefore("#cluetip").hide(),b.css({position:"absolute",zIndex:q}),d.css({position:"relative",zIndex:q+1}),f=a('<div id="cluetip-arrows" class="cluetip-arrows"></div>').css({zIndex:q+1}).appendTo("#cluetip"));var t=o.dropShadow?+o.dropShadowSteps:0;if(!g){g=a([]);for(var u=0;u<t;u++)g=g.add(a("<div></div>").css({zIndex:q-u-1,opacity:.1,top:1+u,left:1+u}));g.css({position:"absolute",backgroundColor:"#000"}).prependTo(b)}var v=n.attr(o.attribute),w=o.cluetipClass;if(!v&&!o.splitTitle&&!k)return!0;o.local&&o.hideLocal&&a(v+":first").hide();var z,A,C,D,E,F,G,H,L,M,O,P,Q,x=parseInt(o.topOffset,10),y=parseInt(o.leftOffset,10),B=isNaN(parseInt(o.height,10))?"auto":/\D/g.test(o.height)?o.height:o.height+"px",I=isNaN(parseInt(o.width,10))?275:parseInt(o.width,10),J=I+(parseInt(b.css("paddingLeft"))||0)+(parseInt(b.css("paddingRight"))||0)+t,K=this.offsetWidth,R="title"!=o.attribute?n.attr(o.titleAttribute):"";o.splitTitle&&(void 0==R&&(R=""),Q=R.split(o.splitTitle),R=Q.shift());var T=function(e){if(!o.onActivate(n))return!1;if(r=!0,b.removeClass().css({width:I}),v==n.attr("href")&&n.css("cursor",o.cursor),n.attr("title",""),o.hoverClass&&n.addClass(o.hoverClass),D=E=n.offset().top,L=n.offset().left,O=e.pageX,G=e.pageY,"area"!=n[0].tagName.toLowerCase()&&(C=a(document).scrollTop(),P=a(window).width()),"fixed"==o.positionBy)M=K+L+y,b.css({left:M});else{M=K>L&&L>J||L+K+J+y>P?L-J-y:K+L+y,("area"==n[0].tagName.toLowerCase()||"mouse"==o.positionBy||K+J>P)&&(O+20+J>P?(b.addClass(" cluetip-"+w),M=O-J-y>=0?O-J-y-parseInt(b.css("marginLeft"),10)+parseInt(c.css("marginRight"),10):O-J/2):M=O+y);var f=M<0?e.pageY+x:e.pageY;b.css({left:M>0&&"bottomTop"!=o.positionBy?M:O+J/2>P?P/2-J/2:Math.max(O-J/2,0)})}if(A=a(window).height(),k)c.html(k),U(f);else if(Q){for(var g=Q.length,i=0;i<g;i++)0==i?c.html(Q[i]):c.append('<div class="split-body">'+Q[i]+"</div>");U(f)}else if(o.local||0==v.indexOf("#")){if(o.local){var l=a(v+":first"),m=a.fn.wrapInner?l.wrapInner("<div></div>").children().clone(!0):l.html();a.fn.wrapInner?c.empty().append(m):c.html(m),U(f)}}else if(p&&o.ajaxCache)c.html(p),U(f);else{var j=o.ajaxSettings;j.url=v,j.beforeSend=function(){d.children().empty(),o.waitImage&&a("#cluetip-waitimage").css({top:G+20,left:O+20}).show()},j.error=function(){r&&c.html("<i>sorry, the contents could not be loaded</i>")},j.success=function(a){p=o.ajaxProcess(a),r&&c.html(p)},j.complete=function(){h=a("#cluetip-inner img").length,h&&!a.browser.opera?a("#cluetip-inner img").load(function(){--h<1&&(a("#cluetip-waitimage").hide(),r&&U(f))}):(a("#cluetip-waitimage").hide(),r&&U(f))},a.ajax(j)}},U=function(h){function j(){}if(b.addClass("cluetip-"+w),o.truncate){var i=c.text().slice(0,o.truncate)+"...";c.html(i)}if(R?e.show().html(R):o.showTitle?e.show().html("&nbsp;"):e.hide(),o.sticky){var k=a('<div id="cluetip-close"><a href="#">'+o.closeText+"</a></div>");"bottom"==o.closePosition?k.appendTo(c):"title"==o.closePosition?k.prependTo(e):k.prependTo(c),k.click(function(){return W(),!1}),o.mouseOutClose?a.fn.hoverIntent&&o.hoverIntent?b.hoverIntent({over:j,timeout:o.hoverIntent.timeout,out:function(){k.trigger("click")}}):b.hover(j,function(){k.trigger("click")}):b.unbind("mouseout")}var l="";if(d.css({overflow:"auto"==B?"visible":"auto",height:B}),z="auto"==B?Math.max(b.outerHeight(),b.height()):parseInt(B,10),F=E,H=C+A,"fixed"==o.positionBy?F=E-o.dropShadowSteps+x:M<O&&Math.max(M,0)+J>O||"bottomTop"==o.positionBy?E+z+x>H&&G-C>z+x?(F=G-z-x,l="top"):(F=G+x,l="bottom"):F=E+z+x>H?z>=A?C:H-z-x:"block"==n.css("display")||"area"==n[0].tagName.toLowerCase()||"mouse"==o.positionBy?h-x:E-o.dropShadowSteps,""==l&&(l=M<L?"left":"right"),b.css({top:F+"px"}).removeClass().addClass("clue-"+l+"-"+w).addClass(" cluetip-"+w),o.arrows){var m=E-F-o.dropShadowSteps;f.css({top:/(left|right)/.test(l)&&M>=0&&m>0?m+"px":/(left|right)/.test(l)?0:""}).show()}else f.hide();g.hide(),b.hide()[o.fx.open]("show"!=o.fx.open&&o.fx.openSpeed),o.dropShadow&&g.css({height:z,width:I}).show(),a.fn.bgiframe&&b.bgiframe(),o.delayedClose>0&&(s=setTimeout(W,o.delayedClose)),o.onShow(b,c)},V=function(){r=!1,a("#cluetip-waitimage").hide(),o.sticky&&!/click|toggle/.test(o.activation)||(W(),clearTimeout(s)),o.hoverClass&&n.removeClass(o.hoverClass),a(".cluetip-clicked").removeClass("cluetip-clicked")},W=function(){d.parent().hide().removeClass().end().children().empty(),R&&n.attr(o.titleAttribute,R),n.css("cursor",""),o.arrows&&f.css({top:""})};if(/click|toggle/.test(o.activation))n.click(function(c){return b.is(":hidden")||!n.is(".cluetip-clicked")?(T(c),a(".cluetip-clicked").removeClass("cluetip-clicked"),n.addClass("cluetip-clicked")):V(c),this.blur(),!1});else if("focus"==o.activation)n.focus(function(a){T(a)}),n.blur(function(a){V(a)});else{n.click(function(){if(n.attr("href")&&n.attr("href")==v&&!o.clickThrough)return!1});var X=function(a){if(1==o.tracking){var c=M-a.pageX,d=F?F-a.pageY:E-a.pageY;n.mousemove(function(a){b.css({left:a.pageX+c,top:a.pageY+d})})}};a.fn.hoverIntent&&o.hoverIntent?n.mouseover(function(){n.attr("title","")}).hoverIntent({sensitivity:o.hoverIntent.sensitivity,interval:o.hoverIntent.interval,over:function(a){T(a),X(a)},timeout:o.hoverIntent.timeout,out:function(a){V(a),n.unbind("mousemove")}}):n.hover(function(a){T(a),X(a)},function(a){V(a),n.unbind("mousemove")})}})},a.fn.cluetip.defaults={width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:!1,hideLocal:!0,attribute:"rel",titleAttribute:"helpTitle",splitTitle:"",showTitle:!0,cluetipClass:"default",hoverClass:"",waitImage:!0,cursor:"help",arrows:!1,dropShadow:!0,dropShadowSteps:6,sticky:!1,mouseOutClose:!1,activation:"hover",clickThrough:!1,tracking:!1,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(a){return!0},onShow:function(a,b){},ajaxCache:!0,ajaxProcess:function(a){return a=a.replace(/<s(cript|tyle)(.|\s)*?\/s(cript|tyle)>/g,"").replace(/<(link|title)(.|\s)*?\/(link|title)>/g,"")},ajaxSettings:{dataType:"html"},debug:!1};var i="appendTo",j="body";a.cluetip={},a.cluetip.setup=function(a){a&&a.insertionType&&a.insertionType.match(/appendTo|prependTo|insertBefore|insertAfter/)&&(i=a.insertionType),a&&a.insertionElement&&(j=a.insertionElement)}}(jQuery);